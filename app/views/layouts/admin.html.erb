<!DOCTYPE html>
<html>
<head>
  <title><%= t('app_name') %> - Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= javascript_importmap_tags %>

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <!-- Select2 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />

  <%= stylesheet_link_tag 'admin', media: 'all' %>
  
  <!-- Scripts in head to ensure jQuery is available -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <%= javascript_include_tag 'admin' %>
</head>
<body class="fixed-header sidebar-expand-lg bg-body-tertiary">
<!--begin::App Wrapper-->
<div class="app-wrapper">
  <!--begin::Header-->
  <nav class="app-header navbar navbar-expand bg-body">
    <!--begin::Container-->
    <div class="container-fluid">
      <!--begin::Start Navbar Links-->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-lte-toggle="sidebar" href="#" role="button">
            <i class="bi bi-list"></i>
          </a>
        </li>
      </ul>
      <!--end::Start Navbar Links-->

      <!--begin::End Navbar Links-->
      <ul class="navbar-nav ms-auto">
        <!--begin::Gestión Dropdown-->
        <% if current_user&.current_gestion %>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">
              <i class="bi bi-calendar3"></i>
              <span class="d-none d-md-inline"><%= current_user.current_gestion.name %></span>
            </a>
            <ul class="dropdown-menu dropdown-menu-end">
              <% current_user.gestions.active.each do |gestion| %>
                <li>
                  <%= form_with url: set_gestion_path, method: :post, local: true, class: "d-inline" do |f| %>
                    <%= f.hidden_field :gestion_id, value: gestion.id %>
                    <%= f.submit gestion.name,
                        class: "dropdown-item #{'active' if gestion.id == current_user.current_gestion.id}" %>
                  <% end %>
                </li>
              <% end %>
              <li><hr class="dropdown-divider"></li>
              <li><%= link_to t('auth.gestion.new'), new_admin_gestion_path, class: "dropdown-item" %></li>
            </ul>
          </li>
        <% end %>
        <!--end::Gestión Dropdown-->

        <!--begin::User Menu Dropdown-->
        <% if current_user %>
          <li class="nav-item dropdown user-menu">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
              <span class="d-none d-md-inline"><%= current_user.full_name %></span>
            </a>
            <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-end">
              <li class="user-header text-bg-primary">
                <p>
                  <%= current_user.full_name %>
                  <small><%= current_user.role.name %></small>
                </p>
              </li>
              <li class="user-footer">
                <%= link_to t('admin.menu.profile'), admin_user_path(current_user), class: "btn btn-default btn-flat" %>
                <%= button_to t('auth.logout.btn'), logout_path,
                    method: :delete,
                    class: "btn btn-default btn-flat float-end" %>
              </li>
            </ul>
          </li>
        <% end %>
        <!--end::User Menu Dropdown-->
      </ul>
      <!--end::End Navbar Links-->
    </div>
    <!--end::Container-->
  </nav>
  <!--end::Header-->
  <!--begin::Sidebar-->
  <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
    <!--begin::Sidebar Brand-->
    <div class="sidebar-brand">
      <a href="<%= admin_root_path %>" class="brand-link">
        <span class="brand-text fw-light"><%= t('app_name') %></span>
      </a>
    </div>
    <!--end::Sidebar Brand-->
    <!--begin::Sidebar Wrapper-->
    <div class="sidebar-wrapper">
      <nav class="mt-2">
        <!--begin::Sidebar Menu-->
        <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="navigation" data-accordion="false">
          <!-- Administration -->
          <li class="nav-header">ADMINISTRATION</li>
          <li class="nav-item <%= 'menu-open' if ['admin/personals', 'admin/professions', 'admin/users'].include?(controller_path) %>">
            <a href="#" class="nav-link <%= 'active' if ['admin/personals', 'admin/professions', 'admin/users'].include?(controller_path) %>">
              <i class="nav-icon bi bi-people"></i>
              <p>
                Human Resources
                <i class="nav-arrow bi bi-chevron-right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="<%= admin_personals_path %>" class="nav-link <%= 'active' if controller_path == 'admin/personals' %>">
                  <i class="nav-icon bi bi-person-badge"></i>
                  <p><%= t('admin.menu.personal') %></p>
                </a>
              </li>
              <li class="nav-item">
                <a href="<%= admin_professions_path %>" class="nav-link <%= 'active' if controller_path == 'admin/professions' %>">
                  <i class="nav-icon bi bi-mortarboard"></i>
                  <p><%= t('admin.menu.professions') %></p>
                </a>
              </li>
              <li class="nav-item">
                <a href="<%= admin_users_path %>" class="nav-link <%= 'active' if controller_path == 'admin/users' %>">
                  <i class="nav-icon bi bi-person-lock"></i>
                  <p><%= t('admin.menu.users') %></p>
                </a>
              </li>
            </ul>
          </li>
          <li class="nav-item <%= 'menu-open' if ['admin/positions', 'admin/departments'].include?(controller_path) %>">
            <a href="#" class="nav-link <%= 'active' if ['admin/positions', 'admin/departments'].include?(controller_path) %>">
              <i class="nav-icon bi bi-diagram-3"></i>
              <p>
                Organization
                <i class="nav-arrow bi bi-chevron-right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="<%= admin_positions_path %>" class="nav-link <%= 'active' if controller_path == 'admin/positions' %>">
                  <i class="nav-icon bi bi-briefcase"></i>
                  <p><%= t('admin.menu.positions') %></p>
                </a>
              </li>
              <li class="nav-item">
                <a href="<%= admin_departments_path %>" class="nav-link <%= 'active' if controller_path == 'admin/departments' %>">
                  <i class="nav-icon bi bi-building"></i>
                  <p>Departments</p>
                </a>
              </li>
            </ul>
          </li>
          <li class="nav-item">
            <a href="<%= admin_gestions_path %>" class="nav-link <%= 'active' if controller_path == 'admin/gestions' %>">
              <i class="nav-icon bi bi-calendar-range"></i>
              <p><%= t('admin.menu.gestions') %></p>
            </a>
          </li>

          <!-- Orders -->
          <li class="nav-header">ORDERS</li>
          <li class="nav-item">
            <a href="<%= admin_fuel_orders_path %>" class="nav-link <%= 'active' if controller_path == 'admin/fuel_orders' %>">
              <i class="nav-icon bi bi-file-earmark-text"></i>
              <p><%= t('admin.menu.fuel_orders') %></p>
            </a>
          </li>

          <!-- Vehicle Fleet -->
          <li class="nav-header">VEHICLE FLEET</li>
          <li class="nav-item <%= 'menu-open' if ['admin/vehicle_types', 'admin/vehicles'].include?(controller_path) %>">
            <a href="#" class="nav-link <%= 'active' if ['admin/vehicle_types', 'admin/vehicles'].include?(controller_path) %>">
              <i class="nav-icon bi bi-truck"></i>
              <p>
                Vehicles
                <i class="nav-arrow bi bi-chevron-right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a href="<%= admin_vehicle_types_path %>" class="nav-link <%= 'active' if controller_path == 'admin/vehicle_types' %>">
                  <i class="nav-icon bi bi-car-front"></i>
                  <p>Vehicle Types</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="<%= admin_vehicles_path %>" class="nav-link <%= 'active' if controller_path == 'admin/vehicles' %>">
                  <i class="nav-icon bi bi-truck-front"></i>
                  <p>Vehicles</p>
                </a>
              </li>
            </ul>
          </li>
          <li class="nav-item">
            <a href="<%= admin_fuels_path %>" class="nav-link <%= 'active' if controller_path == 'admin/fuels' %>">
              <i class="nav-icon bi bi-fuel-pump-fill"></i>
              <p><%= t('admin.menu.fuels') %></p>
            </a>
          </li>
        </ul>
        <!--end::Sidebar Menu-->
      </nav>
    </div>
    <!--end::Sidebar Wrapper-->
  </aside>
  <!--end::Sidebar-->
  <!--begin::App Main-->
  <main class="app-main">
    <!--begin::App Content-->
    <div class="app-content">
      <div class="container-fluid">
        <%= yield %>
      </div>
    </div>
    <!--end::App Content-->
  </main>
  <!--end::App Main-->
  <!--begin::Footer-->
  <footer class="app-footer">
    <strong>
      Copyright &copy; 2024&nbsp;
      <a href="#" class="text-decoration-none"><%= t('app_name') %></a>.
    </strong>
    All rights reserved.
  </footer>
  <!--end::Footer-->
</div>
<!--end::App Wrapper-->

<script>
  $(document).ready(function() {
    $('.select2').select2({
      theme: 'bootstrap-5',
      width: '100%'
    });
  });
</script>
</body>
</html>
