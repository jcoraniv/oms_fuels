<div class="card">
  <div class="card-header">
    <h3 class="card-title"><%= t('admin.fuel_orders.title') %></h3>
    <div class="card-tools">
      <%= link_to t('admin.fuel_orders.new'), new_admin_fuel_order_path, class: "btn btn-primary" %>
    </div>
  </div>
  <div class="card-body p-0">
    <table class="table table-striped">
      <thead>
        <tr>
          <th><%= t('admin.fuel_orders.table.number') %></th>
          <th><%= t('admin.fuel_orders.table.requester') %></th>
          <th>Approved By</th>
          <th><%= t('admin.fuel_orders.table.total') %></th>
          <th><%= t('admin.fuel_orders.table.status') %></th>
          <th style="width: 250px"><%= t('common.actions') %></th>
        </tr>
      </thead>
      <tbody>
        <% @fuel_orders.each do |order| %>
          <tr>
            <td><%= link_to order.formatted_number, admin_fuel_order_path(order), class: "text-primary" %></td>
            <td><%= order.requester_assignment.personal.full_name %></td>
            <td>
              <% if order.approver_assignment %>
                <%= order.approver_assignment.personal.full_name %>
              <% else %>
                <span class="text-muted">-</span>
              <% end %>
            </td>
            <td><%= number_to_currency(order.total) %></td>
            <td>
              <% 
                badge_color = case order.status
                when 'pending' then 'warning'
                when 'approved' then 'success'
                when 'completed' then 'info'
                when 'canceled' then 'danger'
                end
              %>
              <span class="badge bg-<%= badge_color %>"><%= t("admin.fuel_orders.status.#{order.status}") %></span>
            </td>
            <td>
              <% if order.pending? %>
                <%= button_to 'Approve', approve_admin_fuel_order_path(order), method: :patch, class: "btn btn-sm btn-success", form: { style: "display: inline-block;" } %>
                <%= button_to 'Cancel', cancel_admin_fuel_order_path(order), method: :patch, data: { turbo_confirm: 'Are you sure?' }, class: "btn btn-sm btn-danger", form: { style: "display: inline-block;" } %>
              <% elsif order.approved? %>
                <%= button_to 'Complete', complete_admin_fuel_order_path(order), method: :patch, class: "btn btn-sm btn-info", form: { style: "display: inline-block;" } %>
                <%= button_to 'Cancel', cancel_admin_fuel_order_path(order), method: :patch, data: { turbo_confirm: 'Are you sure?' }, class: "btn btn-sm btn-danger", form: { style: "display: inline-block;" } %>
              <% elsif order.completed? %>
                <%= link_to 'Print', admin_fuel_order_path(order, format: :pdf), class: "btn btn-sm btn-secondary", target: "_blank" %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
